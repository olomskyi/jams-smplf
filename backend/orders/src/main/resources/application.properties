spring.application.name=orders
spring.threads.virtual.enabled=true
spring.config.import=optional:classpath:application-local.properties
server.port=8081

inventory.url=http://inventory-app:8082

########################################
# MySql
########################################
spring.datasource.url=jdbc:mysql://${DB_HOST:localhost}:${DB_PORT:3306}/${MYSQL_DATABASE}
spring.datasource.username=${MYSQL_USER}
spring.datasource.password=${MYSQL_PASSWORD}
spring.jpa.hibernate.ddl-auto=none
spring.sql.init.platform=mysql
spring.sql.init.mode=always
spring.flyway.enabled=false

########################################
# H2 in-memory
########################################
#spring.datasource.url=jdbc:h2:mem:testdb
#spring.datasource.driver-class-name=org.h2.Driver
#spring.datasource.username=sa
#spring.datasource.password=
#spring.jpa.hibernate.ddl-auto=create-drop
#spring.sql.init.mode=never
#spring.flyway.enabled=false

# Open API
# http://localhost:8081/swagger-ui.html REST API DOC
springdoc.swagger-ui.path=/swagger-ui.html
# http://localhost:8081/api-docs
springdoc.api-docs.path=/api-docs

### CIRCUIT BREAKER
# Actuator Endpoints
management.health.circuitbreakers.enabled=true
management.endpoints.web.exposure.include=*
management.endpoint.health.show-details=always
# Resilence4j
resilience4j.circuitbreaker.instances.inventory.registerHealthIndicator=true
resilience4j.circuitbreaker.instances.inventory.slidingWindowType=COUNT_BASED
resilience4j.circuitbreaker.instances.inventory.slidingWindowSize=10
resilience4j.circuitbreaker.instances.inventory.failureRateThreshold=50
resilience4j.circuitbreaker.instances.inventory.waitDurationInOpenState=5s
resilience4j.circuitbreaker.instances.inventory.permittedNumberOfCallsInHalfOpenState=3
resilience4j.circuitbreaker.instances.inventory.automaticTransitionFromOpenToHalfOpenEnabled=true
resilience4j.circuitbreaker.instances.inventory.minimumNumberOfCalls=5
resilience4j.timelimiter.instances.inventory.timeoutDuration=3s
resilience4j.retry.instances.inventory.maxAttempts=3
resilience4j.retry.instances.inventory.waitDuration=2s

# Kafka Producer
spring.kafka.bootstrap-servers=kafka:9092
spring.kafka.template.default-topic=order-topic
# Producer Serializers (Avro)
spring.kafka.producer.key-serializer=org.apache.kafka.common.serialization.StringSerializer
spring.kafka.producer.value-serializer=io.confluent.kafka.serializers.KafkaAvroSerializer
spring.kafka.producer.acks=all
spring.kafka.producer.retries=3

# Schema Registry
spring.kafka.producer.properties.schema.registry.url=http://schema-registry:8091
spring.kafka.producer.properties.specific.avro.reader=true
spring.kafka.producer.properties.auto.register.schemas=true